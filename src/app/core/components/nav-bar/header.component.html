<ng-container *ngIf="!isCheckoutPage; else checkoutNavBar">
  <header class="header">
    <div class="layout">
      <div class="header__main">
        <div class="header__items m-width">
          <div class="header__item_left">
            <button class="search__submit" (click)="toggleMenu()">
              <mat-icon>menu</mat-icon>
            </button>
          </div>
          <div class="header__item_left">
            <div class="header__item-icon">
              <div >
                <button class="search__submit" (click)="toggleSearch()">
                  <mat-icon>search</mat-icon>
                </button>
              </div>
            </div>
            <div class="header__item-body">
              <form [formGroup]="searchForm" class="search" [ngClass]="{'is-active': isSearchActive}">
                <button type="button" class="search__submit">
                  <mat-icon>search</mat-icon>
                </button>
                <input class="search__input" type="text" placeholder="Search by product name" formControlName="search">
                <button type="button" class="search__reset" (click)="toggleSearch()">
                  <mat-icon>close</mat-icon>
                </button>
              </form>
            </div>
          </div>
        </div>
        <!-------------------------------------->
        <div class="header__logo">
          <a class="logo" href="/">
            <img src="assets/images/MainLogo2.png" alt="moda_logo"
                 title="moda_logo" class="logo__image">
          </a>
        </div>
        <!-------------------------------------->
        <div class="header__items">
          <!-------------------A------------------>
          <ng-container *ngIf="currentUser() === null">

            <div class="header__item_left">
              <div class="header__item-icon align-r">
                <a [routerLink]="['/wishlist/']">
                  <ng-container
                    *ngIf="
                    (products$ | async)?.length === 0 ||
                    (products$ | async)?.length === undefined ||
                    (products$ | async)?.length === null;
                    else noValueIconW"
                  >
                    <i class="pi pi-heart header__icon-internal" size="large"></i>
                  </ng-container>
                  <ng-template #noValueIconW>
                    <i class="pi pi-heart header__icon-internal"
                       pBadge value="{{(products$ | async)?.length || null}}"
                       severity="success"
                       size="large">
                    </i>
                  </ng-template>
                </a>
              </div>
            </div>
            <div class="header__item_left">
              <div class="header__item-icon align-r">
                <a (click)="openDialog()">
                  <ng-container
                    *ngIf="
                    (basket$ | async)?.items?.length === 0 ||
                    (basket$ | async)?.items?.length === undefined ||
                    (basket$ | async)?.items?.length === null;
                    else noValueIcon"
                  >
                    <i class="pi pi-shopping-bag header__icon-internal" size="large"></i>
                  </ng-container>
                  <ng-template #noValueIcon>
                    <i class="pi pi-shopping-bag header__icon-internal"
                       pBadge value="{{(basket$ | async)?.items?.length || null}}"
                       severity="success"
                       size="large">
                    </i>
                  </ng-template>
                </a>
              </div>
            </div>
            <div class="header__item_left">
              <div class="header__item-icon align-r">
                <a (click)="openLoginModal()" class="s-hamb">
                  <i class="pi pi-user header__icon-internal" size="large"></i>
                </a>
              </div>
            </div>
          </ng-container>
          <!-------------------B------------------>
          <ng-container *ngIf="currentUser()">
            <div class="header__item_left">
              <div class="header__item-icon ">
                <a [routerLink]="['/wishlist/']">
                  <ng-container
                    *ngIf="
                    (products$ | async)?.length === 0 ||
                    (products$ | async)?.length === undefined ||
                    (products$ | async)?.length === null;
                    else noValueIconW"
                  >
                    <i class="pi pi-heart header__icon-internal" size="large"></i>
                  </ng-container>
                  <ng-template #noValueIconW>
                    <i class="pi pi-heart header__icon-internal"
                       pBadge value="{{(products$ | async)?.length || null}}"
                       severity="success"
                       size="large">
                    </i>
                  </ng-template>
                </a>
              </div>
            </div>
            <div class="header__item_left">
              <div class="header__item-icon ">
                <a (click)="openDialog()">
                  <ng-container *ngIf="(basket$ | async)?.items.length !== 0; else noValueIcon">
                    <i class="pi pi-shopping-bag header__icon-internal"
                       pBadge
                       value="{{(basket$ | async).items.length}}"
                       severity="success"
                       size="large">
                    </i>
                  </ng-container>
                  <ng-template #noValueIcon>
                    <ng-container *ngIf="!(basket$ | async)?.items.length || (basket$ | async)?.items.length === null || (basket$ | async)?.items.length === undefined || (basket$ | async)?.items.length === 0">
                      <i class="pi pi-shopping-bag header__icon-internal" size="large"></i>
                    </ng-container>
                  </ng-template>
                </a>
              </div>
            </div>
            <div class="header__item_left">
              <div class="header__item-icon align-r">
                <a class="s-hamb">
                  <i class="pi pi-user header__icon-internal" size="large"></i>
                </a>
                <div class="header__item-menu">
                  <div class="user-nav">
                    <div class="user-nav__body">
                      <span class="user-nav__name">
                        <svg class="user-nav__icon" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm177.6 62.1C192.8 334.5 218.8 352 256 352s63.2-17.5 78.4-33.9c9-9.7 24.2-10.4 33.9-1.4s10.4 24.2 1.4 33.9c-22 23.8-60 49.4-113.6 49.4s-91.7-25.5-113.6-49.4c-9-9.7-8.4-24.9 1.4-33.9s24.9-8.4 33.9 1.4zM144.4 208a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm192-32a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg>
                        {{currentUser()?.displayName}}
                      </span>
                      <a routerLink="/account/user-information" class="user-nav__link">
                        <mat-icon>account_circle</mat-icon>
                        Personal info
                      </a>
                      <a routerLink="/account/user-information" class="user-nav__link">
                        <mat-icon>visibility</mat-icon>
                        Seen
                      </a>
                      <a routerLink="/account/orders" class="user-nav__link">
                        <mat-icon>shopping_cart</mat-icon>
                        Orders
                      </a>
                      <a routerLink="/account/reviews" class="user-nav__link">
                        <mat-icon>mark_chat_read</mat-icon>
                        Reviews
                      </a>
                      <a routerLink="/account/settings" class="user-nav__link">
                        <mat-icon>settings</mat-icon>
                        Settings
                      </a>
                      <a (click)="exit()" class="user-nav__link">
                        <mat-icon>logout</mat-icon>
                        Logout
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </div>
      <div [@fastCascade]="(searchResults$ | async)?.data?.length">
        <app-product-list-item
          *ngFor="let result of (searchResults$ | async)?.data"
          [product]="result">
        </app-product-list-item>
      </div>
      <app-nav-modal [isMenuActive]="isMenuActive"></app-nav-modal>
    </div>
  </header>
</ng-container>

<ng-template #checkoutNavBar>
  <header class="checkout-header">
    <div class="layout">
      <div class="checkout-header__inner">
        <div class="checkout-header__main">
          <div class="checkout-header__logo">
            <a class="logo" href="/">
              <img src="assets/images/MainLogo2.png" alt="moda_logo"
                   title="shafa_logo" class="logo__image">
            </a>
          </div>
        </div>
      </div>
    </div>
  </header>
</ng-template>
<p-toast></p-toast>
<p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog>


